# Deployment Files Reference

This directory contains a complete automated deployment system for Vercel.

---

## File Structure

```
phase-2-web/
├── deploy-to-vercel.ps1               (9.1 KB)  ← Windows automation script
├── deploy-to-vercel.sh                (11 KB)   ← Linux/macOS automation script
├── QUICK-START.md                     (1.9 KB)  ← Start here!
├── VERCEL-AUTOMATION-GUIDE.md         (15 KB)   ← Complete documentation
├── deployment-example-output.txt      (7.3 KB)  ← Example script output
├── DEPLOYMENT-AUTOMATION-SUMMARY.md   (18 KB)   ← Technical deep dive
├── DEPLOYMENT.md                      (4.8 KB)  ← Manual deployment (fallback)
└── vercel-env-setup.txt               (5.8 KB)  ← Generated env vars (legacy)
```

**Total Size:** ~73 KB of documentation and automation

---

## Where to Start

### First-Time Users
1. Read `QUICK-START.md` (2 minutes)
2. Run deployment script (see commands below)
3. Check `deployment-example-output.txt` if you encounter issues

### Power Users
1. Read `VERCEL-AUTOMATION-GUIDE.md` for advanced workflows
2. Customize script parameters as needed
3. Review `DEPLOYMENT-AUTOMATION-SUMMARY.md` for technical architecture

### Manual Deployment (Not Recommended)
1. Use `DEPLOYMENT.md` if automation scripts don't work
2. Follow `vercel-env-setup.txt` for environment variables

---

## Quick Command Reference

### Windows (PowerShell)

```powershell
# Basic deployment
.\deploy-to-vercel.ps1 -DatabaseUrl "postgresql+asyncpg://user:pass@host/db?ssl=require"

# With custom URLs
.\deploy-to-vercel.ps1 `
    -DatabaseUrl "postgresql+asyncpg://..." `
    -FrontendUrl "https://frontend-xyz.vercel.app" `
    -BackendUrl "https://backend-xyz.vercel.app"

# Only update environment variables (don't redeploy)
.\deploy-to-vercel.ps1 -DatabaseUrl "postgresql+asyncpg://..." -SkipDeploy

# Get help
Get-Help .\deploy-to-vercel.ps1 -Full
```

### Linux/macOS/WSL (Bash)

```bash
# Make script executable (first time only)
chmod +x deploy-to-vercel.sh

# Basic deployment
./deploy-to-vercel.sh --database-url "postgresql+asyncpg://user:pass@host/db?ssl=require"

# With custom URLs
./deploy-to-vercel.sh \
    --database-url "postgresql+asyncpg://..." \
    --frontend-url "https://frontend-xyz.vercel.app" \
    --backend-url "https://backend-xyz.vercel.app"

# Only update environment variables
./deploy-to-vercel.sh --database-url "postgresql+asyncpg://..." --skip-deploy

# Get help
./deploy-to-vercel.sh --help
```

---

## File Descriptions

### `deploy-to-vercel.ps1`
**Purpose:** Windows automation script
**Language:** PowerShell 7+
**Features:**
- Color-coded output
- Parameter validation
- Auto-detection of Vercel URLs
- Idempotent environment variable setting
- Deployment record generation

### `deploy-to-vercel.sh`
**Purpose:** Linux/macOS automation script
**Language:** Bash (POSIX-compliant)
**Features:**
- Same functionality as PowerShell version
- Cross-platform (Linux, macOS, WSL, Git Bash)
- Set executable with `chmod +x`

### `QUICK-START.md`
**Purpose:** Single-page quick reference
**Audience:** All users
**Contents:**
- Prerequisites
- Basic commands
- Post-deployment steps
- Quick troubleshooting

### `VERCEL-AUTOMATION-GUIDE.md`
**Purpose:** Comprehensive documentation
**Audience:** Power users, DevOps engineers
**Contents:**
- Detailed usage instructions
- Security best practices
- Advanced workflows (CI/CD, multi-environment)
- Troubleshooting guide (8 scenarios)
- Cost optimization
- Future enhancements

### `deployment-example-output.txt`
**Purpose:** Show expected script output
**Audience:** Troubleshooters
**Contents:**
- Complete script execution log
- Deployment record example
- Verification commands
- Common error scenarios

### `DEPLOYMENT-AUTOMATION-SUMMARY.md`
**Purpose:** Technical architecture documentation
**Audience:** Engineers, architects
**Contents:**
- Workflow diagram
- Security features
- Performance metrics
- Testing strategy
- Lessons learned

### `DEPLOYMENT.md`
**Purpose:** Manual deployment fallback
**Audience:** Users without CLI access
**Contents:**
- Step-by-step manual instructions
- Vercel dashboard configuration
- Database migration guide

### `vercel-env-setup.txt`
**Purpose:** Legacy environment variables (DEPRECATED)
**Status:** Generated by previous deployment
**Note:** Use automation scripts instead

---

## Workflow Overview

```
┌─────────────────────────────────────────────────────────┐
│ START: Run deployment script                           │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Validate prerequisites:                                 │
│  ✓ Vercel CLI installed                                │
│  ✓ Python 3.13+ available                              │
│  ✓ Authenticated with Vercel                           │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Generate secure JWT secret (256-bit)                    │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Auto-detect or prompt for:                              │
│  - Backend URL (https://backend-*.vercel.app)          │
│  - Frontend URL (https://frontend-*.vercel.app)        │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Display configuration summary                           │
│ Prompt: Press ENTER to continue...                     │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Set backend environment variables:                      │
│  - DATABASE_URL                                         │
│  - SECRET_KEY (auto-generated)                         │
│  - CORS_ORIGINS (JSON array)                           │
│  - ALGORITHM (HS256)                                   │
│  - ACCESS_TOKEN_EXPIRE_MINUTES (1440)                  │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Set frontend environment variables:                     │
│  - NEXT_PUBLIC_API_URL (client-side)                   │
│  - BACKEND_URL (server-side)                           │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Deploy to production:                                   │
│  1. cd backend && vercel --prod                        │
│  2. cd frontend && vercel --prod                       │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ Generate deployment record:                             │
│  - Timestamped filename                                │
│  - Masked secrets                                      │
│  - Verification commands                               │
└────────────┬────────────────────────────────────────────┘
             │
             ▼
┌─────────────────────────────────────────────────────────┐
│ END: Display post-deployment actions                    │
│  - Database migration instructions                     │
│  - Verification commands                               │
└─────────────────────────────────────────────────────────┘
```

---

## Prerequisites

### Required Software

| Tool | Version | Installation |
|------|---------|--------------|
| **Vercel CLI** | Latest | `npm install -g vercel` |
| **Python** | 3.13+ | [python.org](https://python.org) |
| **Node.js** | 18+ | [nodejs.org](https://nodejs.org) |

### Required Accounts

| Service | Purpose | Sign Up |
|---------|---------|---------|
| **Vercel** | Hosting platform | [vercel.com](https://vercel.com) |
| **Neon** | PostgreSQL database | [neon.tech](https://neon.tech) |

### One-Time Setup

```bash
# 1. Install Vercel CLI
npm install -g vercel

# 2. Login to Vercel
vercel login

# 3. Create Neon database
# Go to: https://console.neon.tech
# Create database → Copy connection string
```

---

## Post-Deployment Checklist

After running the deployment script:

- [ ] Run database migrations:
  ```bash
  cd backend
  export DATABASE_URL="postgresql+asyncpg://..."
  uv run alembic upgrade head
  ```

- [ ] Test backend health:
  ```bash
  curl https://backend-xyz.vercel.app/health
  ```

- [ ] Test frontend:
  ```bash
  open https://frontend-xyz.vercel.app
  ```

- [ ] Register test user via frontend UI

- [ ] Test task CRUD operations (create, read, update, delete, complete)

- [ ] Save deployment record to password manager

- [ ] Update DNS records (if using custom domain)

---

## Troubleshooting Quick Reference

| Error | Cause | Fix |
|-------|-------|-----|
| "Vercel CLI not found" | CLI not installed | `npm install -g vercel` |
| "Not logged into Vercel" | No authentication | `vercel login` |
| Backend 500 error | Migrations not run | Run `alembic upgrade head` |
| CORS error | Frontend URL not in CORS_ORIGINS | Check backend env vars |
| "relation 'users' does not exist" | Migrations not run | Run `alembic upgrade head` |
| "Invalid JWT token" | Mismatched SECRET_KEY | Regenerate and redeploy |

**Full troubleshooting guide:** See `VERCEL-AUTOMATION-GUIDE.md` section "Troubleshooting"

---

## Security Checklist

Before deploying to production:

- [ ] Never commit `.env` files to git (already gitignored)
- [ ] Use Neon connection pooler endpoints (not direct)
- [ ] Restrict CORS to specific frontend domains (no wildcards)
- [ ] Rotate DATABASE_URL credentials after sharing with team
- [ ] Enable Vercel deployment protection for backend
- [ ] Use HTTPS-only for all production endpoints
- [ ] Store deployment records in secure password manager
- [ ] Review Vercel deployment logs for errors

---

## Support

### Documentation Hierarchy

1. **Quick issue?** → `QUICK-START.md`
2. **Need advanced features?** → `VERCEL-AUTOMATION-GUIDE.md`
3. **Want technical details?** → `DEPLOYMENT-AUTOMATION-SUMMARY.md`
4. **Script not working?** → `deployment-example-output.txt`
5. **Prefer manual process?** → `DEPLOYMENT.md`

### External Resources

- [Vercel CLI Documentation](https://vercel.com/docs/cli)
- [Neon PostgreSQL Docs](https://neon.tech/docs/introduction)
- [FastAPI Deployment](https://fastapi.tiangolo.com/deployment/)
- [Next.js Deployment](https://nextjs.org/docs/deployment)

### Related Project Files

- `E:\M.Y\GIAIC-Hackathons\Evolution-of-Todo\CLAUDE.md` - Project constitution
- `E:\M.Y\GIAIC-Hackathons\Evolution-of-Todo\phase-2-web\backend\CLAUDE.md` - Backend guide
- `E:\M.Y\GIAIC-Hackathons\Evolution-of-Todo\phase-2-web\frontend\CLAUDE.md` - Frontend guide

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0.0 | 2025-12-31 | Initial release: Full automation system |

---

**Maintained by:** DevOps & RAG Engineer
**Last Updated:** 2025-12-31
**License:** MIT
